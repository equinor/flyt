name: Pull Request Linter
on:
  pull_request:
    types:
      - opened
      - edited
      - reopened
      - synchronize
jobs:
  lint-title:
    name: Lint pull request title
    runs-on: ubuntu-latest
    steps:
      - name: Lint pull request title
        uses: jef/conventional-commits-pr-action@v1
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
  lint-code:
    name: ğŸ‘ï¸ Validate code
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ‘€ Checkout Repo
        uses: actions/checkout@v3
        with:
            ref: ${{ github.head_ref }}

      - name: ğŸŒˆ Setup Node.js 18
        uses: actions/setup-node@v3
        with:
            node-version: 18
            cache: yarn
            cache-dependency-path: yarn.lock

      - name: ğŸ“¦ Install Dependencies
        run: yarn install --frozen-lockfile

      - name: ğŸ­ Build project
        run: yarn build
      
      - name: ğŸš¦ Check typescript errors
        run: npx tsc --noEmit

      - name: ğŸš¦ Lint and fix
        run: yarn lint

      - name: ğŸ§ª Run tests
        run: yarn test